{"ast":null,"code":"var _jsxFileName = \"/Volumes/MAC_Quandev03/Code/JS/Shopee/src/pages/ProductDetail/ProductDetail.tsx\",\n  _s = $RefreshSig$();\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\nimport DOMPurify from 'dompurify';\nimport { useEffect, useMemo, useRef, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { productApi } from 'src/api/product.api';\nimport { purchasesApi } from 'src/api/purchases.api';\nimport ToastSuccess from 'src/components/CustomToast/ToastSuccess';\nimport ProductRating from 'src/components/ProductRating';\nimport QuantityController from 'src/components/QuantityController';\nimport { path } from 'src/constants/path';\nimport { purchasesStatus } from 'src/constants/purchases';\nimport { formatCurrency, formatNumberToSocialStyle, getIdFromNameId, saleRate } from 'src/utils/utils';\nimport Product from '../ProductList/components/Product';\nimport { useTranslation } from 'react-i18next';\nimport { Helmet } from 'react-helmet-async';\nimport { convert } from 'html-to-text';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ProductDetail() {\n  _s();\n  const {\n    t\n  } = useTranslation('product');\n  const {\n    nameId\n  } = useParams();\n  const navigate = useNavigate();\n  const id = getIdFromNameId(nameId);\n  const queryClient = useQueryClient();\n  const {\n    data: productDetailData,\n    isLoading,\n    error\n  } = useQuery({\n    queryKey: ['product', id],\n    queryFn: () => {\n      return productApi.getProduct(id);\n    }\n  });\n  const [showToastSuccess, setShowToastSuccess] = useState(false);\n  const [buyCount, setBuyCount] = useState(1);\n  const product = productDetailData === null || productDetailData === void 0 ? void 0 : productDetailData.data.data;\n  const queryConfig = {\n    page: '1',\n    limit: '20',\n    category: product === null || product === void 0 ? void 0 : product.category._id\n  };\n  const {\n    data: productList\n  } = useQuery({\n    queryKey: ['productListCategory', queryConfig],\n    queryFn: () => {\n      return productApi.getProductList(queryConfig);\n    },\n    enabled: Boolean(product)\n  });\n  const imageRef = useRef(null);\n  const [currentImagesIndex, setCurrentImageIndex] = useState([0, 5]);\n  const [imageActived, setImageActived] = useState('');\n  const currentImagesList = useMemo(() => {\n    if (!product) return [];\n    return product.images.slice(...currentImagesIndex);\n  }, [product, currentImagesIndex]);\n  const addToCartMutation = useMutation({\n    mutationFn: body => {\n      return purchasesApi.addToCart(body);\n    }\n  });\n  useEffect(() => {\n    if (product && product.images.length) {\n      setImageActived(product.images[0]);\n    }\n  }, [product]);\n  const activeImage = img => {\n    setImageActived(img);\n  };\n  const prevSlice = () => {\n    if (currentImagesIndex[0] <= 0) return;\n    setCurrentImageIndex(prev => [prev[0] - 1, prev[1] - 1]);\n  };\n  const nextSlice = () => {\n    if (currentImagesIndex[1] >= (product === null || product === void 0 ? void 0 : product.images.length)) return;\n    setCurrentImageIndex(prev => [prev[0] + 1, prev[1] + 1]);\n  };\n  const handleImageZoom = event => {\n    const rect = event.currentTarget.getBoundingClientRect();\n    const image = imageRef.current;\n    const {\n      naturalWidth,\n      naturalHeight\n    } = image;\n\n    //Cách 1: Lấy offsetX và offsetY đơn giản trong trường hợp xử lý được bubble event\n    // const { offsetX, offsetY } = event.nativeEvent;\n\n    //Cách 2: Tính toán offsetX và offsetY trong trường hợp không xử lý được bubble event đối với element con, ví dụ trường hợp element con là một component được import bên ngoài vào element cha\n\n    const offsetX = event.pageX - (rect.x + window.scrollX);\n    const offsetY = event.pageY - (rect.y + window.scrollY);\n    const top = offsetY * (1 - naturalHeight / rect.height);\n    const left = offsetX * (1 - naturalWidth / rect.width);\n    image.style.width = naturalWidth + 'px';\n    image.style.height = naturalHeight + 'px';\n    image.style.maxWidth = 'unset';\n    image.style.top = top + 'px';\n    image.style.left = left + 'px';\n  };\n  const handleRemoveZoom = () => {\n    var _imageRef$current;\n    (_imageRef$current = imageRef.current) === null || _imageRef$current === void 0 ? void 0 : _imageRef$current.removeAttribute('style');\n  };\n\n  // todo: thay đổi số lượng mua\n  const handleChangeQuantity = value => {\n    setBuyCount(value);\n  };\n\n  // todo thêm vào giỏ hàng\n  const handleAddToCart = body => {\n    addToCartMutation.mutate(body, {\n      onSuccess: () => {\n        // toast.success('Thêm vào giỏ hàng thành công', { autoClose: 1000 });\n        // customToast.renderToastSuccess({ duration: 1000 });\n        setShowToastSuccess(true);\n        queryClient.invalidateQueries({\n          queryKey: ['purchasesCart', {\n            status: purchasesStatus.inCart\n          }]\n        });\n      }\n    });\n  };\n  // Todo: nút mua ngay\n  const buyNow = async body => {\n    const res = await addToCartMutation.mutateAsync(body);\n    const purchase = res.data.data;\n    navigate(path.cart, {\n      state: {\n        purchaseId: purchase._id\n      }\n    });\n  };\n  if (isLoading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"Loading...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 144,\n    columnNumber: 25\n  }, this);\n  if (error) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"Error loading product\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 145,\n    columnNumber: 21\n  }, this);\n  if (!product) return null;\n  return (\n    /*#__PURE__*/\n    // Todo: giao diện chi tiết sản phẩm\n    _jsxDEV(\"div\", {\n      className: \"relative bg-gray-100 py-3\",\n      children: [/*#__PURE__*/_jsxDEV(Helmet, {\n        children: [/*#__PURE__*/_jsxDEV(\"title\", {\n          children: product.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n          name: \"description\",\n          content: convert(product.description || '', {\n            limits: {\n              maxInputLength: 200\n            }\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container bg-white shadow\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-12 gap-9\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-span-5\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"relative w-full cursor-zoom-in overflow-hidden pt-[100%] shadow\",\n              onMouseMove: handleImageZoom,\n              onMouseLeave: handleRemoveZoom,\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: imageActived,\n                alt: product.name,\n                className: \"absolute left-0 top-0 h-full w-full  bg-white object-cover\",\n                ref: imageRef\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 171,\n                columnNumber: 15\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 166,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"relative mt-4 grid w-full grid-cols-5 gap-5\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: prevSlice,\n                className: \"absolute left-0 top-1/2 z-10 h-9 w-5 -translate-y-1/2 bg-gray-200/60 font-semibold text-white\",\n                children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                  xmlns: \"http://www.w3.org/2000/svg\",\n                  fill: \"none\",\n                  viewBox: \"0 0 24 24\",\n                  strokeWidth: \"{1.5}\",\n                  stroke: \"currentColor\",\n                  className: \"h-6 w-6\",\n                  children: /*#__PURE__*/_jsxDEV(\"path\", {\n                    strokeLinecap: \"round\",\n                    strokeLinejoin: \"round\",\n                    d: \"M15.75 19.5L8.25 12l7.5-7.5\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 192,\n                    columnNumber: 19\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 184,\n                  columnNumber: 17\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 180,\n                columnNumber: 15\n              }, this), currentImagesList.map(image => {\n                const isActive = image === imageActived;\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"relative w-full cursor-pointer pt-[100%]\",\n                  onMouseEnter: () => activeImage(image),\n                  children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                    src: image,\n                    alt: image,\n                    className: \"absolute left-0 top-0 w-full object-contain\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 205,\n                    columnNumber: 21\n                  }, this), isActive && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"absolute left-0 top-0 h-full w-full border border-orange bg-transparent\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 207,\n                    columnNumber: 23\n                  }, this)]\n                }, image, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 200,\n                  columnNumber: 19\n                }, this);\n              }), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: nextSlice,\n                className: \"absolute right-0 top-1/2 z-10 h-9 w-5 -translate-y-1/2 bg-gray-200/60 font-semibold text-white\",\n                children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                  xmlns: \"http://www.w3.org/2000/svg\",\n                  fill: \"none\",\n                  viewBox: \"0 0 24 24\",\n                  strokeWidth: \"{1.5}\",\n                  stroke: \"currentColor\",\n                  className: \"h-6 w-6\",\n                  children: /*#__PURE__*/_jsxDEV(\"path\", {\n                    strokeLinecap: \"round\",\n                    strokeLinejoin: \"round\",\n                    d: \"M8.25 4.5l7.5 7.5-7.5 7.5\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 225,\n                    columnNumber: 19\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 217,\n                  columnNumber: 17\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 213,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 179,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-span-7\",\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"text-xl font-medium uppercase\",\n              children: product.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"my-4 flex items-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center gap-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"mt-1 text-orange underline\",\n                  children: product.rating\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 235,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(ProductRating, {\n                  rating: product.rating,\n                  classNameStartFilled: \"h-4 w-4 fill-orange text-orange\",\n                  classNameNonStartFilled: \"h-4 w-4 fill-current text-gray-300\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 236,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 234,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mx-4 h-6 w-[1px] bg-gray-300\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 243,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: formatNumberToSocialStyle(product.sold)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 246,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"ml-1 text-sm capitalize text-gray-500\",\n                  children: t('sold')\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 247,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 245,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center bg-gray-100 px-6 py-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-500 line-through\",\n                children: [\"\\u20AB\", formatCurrency(product.price_before_discount)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 252,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ml-3 text-3xl text-orange\",\n                children: [\"\\u20AB\", formatCurrency(product.price)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 254,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ml-5 rounded-sm bg-orange px-1 text-sm font-semibold uppercase text-white\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: [saleRate(product.price_before_discount, product.price), \" \"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 257,\n                  columnNumber: 17\n                }, this), t('off')]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 256,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 251,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-6 flex items-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"capitalize text-gray-500\",\n                children: t('quantity')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 263,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(QuantityController, {\n                onDecrease: handleChangeQuantity,\n                onIncrease: handleChangeQuantity,\n                onType: handleChangeQuantity,\n                value: buyCount,\n                max: product.quantity\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 265,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ml-5 text-gray-500\",\n                children: [product.quantity, \" \", t('pieces available')]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 273,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-6 flex items-center gap-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  handleAddToCart({\n                    product_id: id,\n                    buy_count: buyCount\n                  });\n                },\n                className: \"flex-items-center flex gap-2 rounded-sm border border-orange bg-orange/10 px-5 py-3 capitalize text-orange hover:bg-orange/20\",\n                children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                  xmlns: \"http://www.w3.org/2000/svg\",\n                  fill: \"none\",\n                  viewBox: \"0 0 24 24\",\n                  strokeWidth: \"{1.5}\",\n                  stroke: \"currentColor\",\n                  className: \"h-5 w-5\",\n                  children: /*#__PURE__*/_jsxDEV(\"path\", {\n                    strokeLinecap: \"round\",\n                    strokeLinejoin: \"round\",\n                    d: \"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 00-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 00-16.536-1.84M7.5 14.25L5.106 5.272M6 20.25a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm12.75 0a.75.75 0 11-1.5 0 .75.75 0 011.5 0z\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 293,\n                    columnNumber: 19\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 285,\n                  columnNumber: 17\n                }, this), t('add to cart')]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 279,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  buyNow({\n                    product_id: id,\n                    buy_count: buyCount\n                  });\n                },\n                className: \"rounded-sm bg-orange px-5 py-3 capitalize text-white hover:bg-orange/80\",\n                children: t('buy now')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 302,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 278,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container mt-4 bg-white\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-gray-100/40 p-3 text-lg uppercase\",\n          children: t('product description')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-3 text-sm leading-loose\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            dangerouslySetInnerHTML: {\n              __html: DOMPurify.sanitize(product.description)\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 318,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container mt-4\",\n        children: productList && /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"uppercase text-gray-500\",\n            children: t('you may also like')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 324,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mt-8 grid grid-cols-2 gap-4 sm:grid-cols-3 lg:grid-cols-5 xl:grid-cols-6\",\n            children: productList.data.data.products.map(product => /*#__PURE__*/_jsxDEV(Product, {\n              product: product\n            }, product._id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 327,\n              columnNumber: 17\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 325,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 321,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(ToastSuccess, {\n        setShow: setShowToastSuccess,\n        show: showToastSuccess,\n        message: \"S\\u1EA3n ph\\u1EA9m \\u0111\\xE3 \\u0111\\u01B0\\u1EE3c th\\xEAm v\\xE0o Gi\\u1ECF h\\xE0ng\",\n        duration: 1500\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 5\n    }, this)\n  );\n}\n_s(ProductDetail, \"VVPM9PdC/5B7wWF4jsa6yClkD3M=\", false, function () {\n  return [useTranslation, useParams, useNavigate, useQueryClient, useQuery, useQuery, useMutation];\n});\n_c = ProductDetail;\nvar _c;\n$RefreshReg$(_c, \"ProductDetail\");","map":{"version":3,"names":["useMutation","useQuery","useQueryClient","DOMPurify","useEffect","useMemo","useRef","useState","useNavigate","useParams","productApi","purchasesApi","ToastSuccess","ProductRating","QuantityController","path","purchasesStatus","formatCurrency","formatNumberToSocialStyle","getIdFromNameId","saleRate","Product","useTranslation","Helmet","convert","jsxDEV","_jsxDEV","ProductDetail","_s","t","nameId","navigate","id","queryClient","data","productDetailData","isLoading","error","queryKey","queryFn","getProduct","showToastSuccess","setShowToastSuccess","buyCount","setBuyCount","product","queryConfig","page","limit","category","_id","productList","getProductList","enabled","Boolean","imageRef","currentImagesIndex","setCurrentImageIndex","imageActived","setImageActived","currentImagesList","images","slice","addToCartMutation","mutationFn","body","addToCart","length","activeImage","img","prevSlice","prev","nextSlice","handleImageZoom","event","rect","currentTarget","getBoundingClientRect","image","current","naturalWidth","naturalHeight","offsetX","pageX","x","window","scrollX","offsetY","pageY","y","scrollY","top","height","left","width","style","maxWidth","handleRemoveZoom","_imageRef$current","removeAttribute","handleChangeQuantity","value","handleAddToCart","mutate","onSuccess","invalidateQueries","status","inCart","buyNow","res","mutateAsync","purchase","cart","state","purchaseId","children","fileName","_jsxFileName","lineNumber","columnNumber","className","name","content","description","limits","maxInputLength","onMouseMove","onMouseLeave","src","alt","ref","onClick","xmlns","fill","viewBox","strokeWidth","stroke","strokeLinecap","strokeLinejoin","d","map","isActive","onMouseEnter","rating","classNameStartFilled","classNameNonStartFilled","sold","price_before_discount","price","onDecrease","onIncrease","onType","max","quantity","product_id","buy_count","dangerouslySetInnerHTML","__html","sanitize","products","setShow","show","message","duration","_c","$RefreshReg$"],"sources":["/Volumes/MAC_Quandev03/Code/JS/Shopee/src/pages/ProductDetail/ProductDetail.tsx"],"sourcesContent":["import { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\nimport DOMPurify from 'dompurify';\nimport { Key, useEffect, useMemo, useRef, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { productApi } from 'src/api/product.api';\nimport { purchasesApi } from 'src/api/purchases.api';\nimport ToastSuccess from 'src/components/CustomToast/ToastSuccess';\nimport ProductRating from 'src/components/ProductRating';\nimport QuantityController from 'src/components/QuantityController';\nimport { path } from 'src/constants/path';\nimport { purchasesStatus } from 'src/constants/purchases';\nimport { ProductListConfig, Product as ProductType } from 'src/@types/product.type';\nimport { ProductCart } from 'src/@types/purchases.type';\nimport { formatCurrency, formatNumberToSocialStyle, getIdFromNameId, saleRate } from 'src/utils/utils';\nimport Product from '../ProductList/components/Product';\nimport { useTranslation } from 'react-i18next';\nimport { Helmet } from 'react-helmet-async';\nimport { convert } from 'html-to-text';\n\nexport default function ProductDetail() {\n  const { t } = useTranslation('product');\n  const { nameId } = useParams();\n  const navigate = useNavigate();\n  const id = getIdFromNameId(nameId as string);\n  const queryClient = useQueryClient();\n  const { data: productDetailData, isLoading, error } = useQuery({\n    queryKey: ['product', id],\n    queryFn: () => {\n      return productApi.getProduct(id as string);\n    }\n  });\n\n  const [showToastSuccess, setShowToastSuccess] = useState(false);\n\n  const [buyCount, setBuyCount] = useState(1);\n\n  const product = productDetailData?.data.data;\n\n  const queryConfig: ProductListConfig = { page: '1', limit: '20', category: product?.category._id };\n\n  const { data: productList } = useQuery({\n    queryKey: ['productListCategory', queryConfig],\n    queryFn: () => {\n      return productApi.getProductList(queryConfig);\n    },\n    enabled: Boolean(product)\n  });\n\n  const imageRef = useRef<HTMLImageElement>(null);\n\n  const [currentImagesIndex, setCurrentImageIndex] = useState([0, 5]);\n\n  const [imageActived, setImageActived] = useState('');\n\n  const currentImagesList = useMemo(() => {\n    if (!product) return [];\n    return product.images.slice(...currentImagesIndex);\n  }, [product, currentImagesIndex]);\n\n  const addToCartMutation = useMutation({\n    mutationFn: (body: ProductCart) => {\n      return purchasesApi.addToCart(body);\n    }\n  });\n\n  useEffect(() => {\n    if (product && product.images.length) {\n      setImageActived(product.images[0]);\n    }\n  }, [product]);\n\n  const activeImage = (img: string) => {\n    setImageActived(img);\n  };\n\n  const prevSlice = () => {\n    if (currentImagesIndex[0] <= 0) return;\n\n    setCurrentImageIndex((prev) => [prev[0] - 1, prev[1] - 1]);\n  };\n\n  const nextSlice = () => {\n    if (currentImagesIndex[1] >= (product as ProductType)?.images.length) return;\n\n    setCurrentImageIndex((prev) => [prev[0] + 1, prev[1] + 1]);\n  };\n\n  const handleImageZoom = (event: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n    const rect = event.currentTarget.getBoundingClientRect();\n\n    const image = imageRef.current as HTMLImageElement;\n    const { naturalWidth, naturalHeight } = image;\n\n    //Cách 1: Lấy offsetX và offsetY đơn giản trong trường hợp xử lý được bubble event\n    // const { offsetX, offsetY } = event.nativeEvent;\n\n    //Cách 2: Tính toán offsetX và offsetY trong trường hợp không xử lý được bubble event đối với element con, ví dụ trường hợp element con là một component được import bên ngoài vào element cha\n\n    const offsetX = event.pageX - (rect.x + window.scrollX);\n    const offsetY = event.pageY - (rect.y + window.scrollY);\n\n    const top = offsetY * (1 - naturalHeight / rect.height);\n    const left = offsetX * (1 - naturalWidth / rect.width);\n\n    image.style.width = naturalWidth + 'px';\n    image.style.height = naturalHeight + 'px';\n    image.style.maxWidth = 'unset';\n    image.style.top = top + 'px';\n    image.style.left = left + 'px';\n  };\n\n  const handleRemoveZoom = () => {\n    imageRef.current?.removeAttribute('style');\n  };\n\n  // todo: thay đổi số lượng mua\n  const handleChangeQuantity = (value: number) => {\n    setBuyCount(value);\n  };\n\n  // todo thêm vào giỏ hàng\n  const handleAddToCart = (body: ProductCart) => {\n    addToCartMutation.mutate(body, {\n      onSuccess: () => {\n        // toast.success('Thêm vào giỏ hàng thành công', { autoClose: 1000 });\n        // customToast.renderToastSuccess({ duration: 1000 });\n        setShowToastSuccess(true);\n        queryClient.invalidateQueries({ queryKey: ['purchasesCart', { status: purchasesStatus.inCart }] });\n      }\n    });\n  };\n// Todo: nút mua ngay\n  const buyNow = async (body: ProductCart) => {\n    const res = await addToCartMutation.mutateAsync(body);\n    const purchase = res.data.data;\n\n    navigate(path.cart, {\n      state: {\n        purchaseId: purchase._id\n      }\n    });\n  };\n\n  if (isLoading) return <div>Loading...</div>;\n  if (error) return <div>Error loading product</div>;\n  if (!product) return null;\n\n  return (\n    // Todo: giao diện chi tiết sản phẩm\n    <div className='relative bg-gray-100 py-3'>\n      <Helmet>\n        <title>{product.name}</title>\n        <meta\n          name='description'\n          content={convert(product.description || '', {\n            limits: {\n              maxInputLength: 200\n            }\n          })}\n        />\n      </Helmet>\n\n      <div className='container bg-white shadow'>\n        <div className='grid grid-cols-12 gap-9'>\n          <div className='col-span-5'>\n            <div\n              className='relative w-full cursor-zoom-in overflow-hidden pt-[100%] shadow'\n              onMouseMove={handleImageZoom}\n              onMouseLeave={handleRemoveZoom}\n            >\n              <img\n                src={imageActived}\n                alt={product.name}\n                className='absolute left-0 top-0 h-full w-full  bg-white object-cover'\n                ref={imageRef}\n              />\n            </div>\n\n            <div className='relative mt-4 grid w-full grid-cols-5 gap-5'>\n              <button\n                onClick={prevSlice}\n                className='absolute left-0 top-1/2 z-10 h-9 w-5 -translate-y-1/2 bg-gray-200/60 font-semibold text-white'\n              >\n                <svg\n                  xmlns='http://www.w3.org/2000/svg'\n                  fill='none'\n                  viewBox='0 0 24 24'\n                  strokeWidth='{1.5}'\n                  stroke='currentColor'\n                  className='h-6 w-6'\n                >\n                  <path strokeLinecap='round' strokeLinejoin='round' d='M15.75 19.5L8.25 12l7.5-7.5' />\n                </svg>\n              </button>\n\n              {currentImagesList.map((image: string) => {\n                const isActive = image === imageActived;\n\n                return (\n                  <div\n                    className='relative w-full cursor-pointer pt-[100%]'\n                    key={image}\n                    onMouseEnter={() => activeImage(image)}\n                  >\n                    <img src={image} alt={image} className='absolute left-0 top-0 w-full object-contain' />\n                    {isActive && (\n                      <div className='absolute left-0 top-0 h-full w-full border border-orange bg-transparent' />\n                    )}\n                  </div>\n                );\n              })}\n\n              <button\n                onClick={nextSlice}\n                className='absolute right-0 top-1/2 z-10 h-9 w-5 -translate-y-1/2 bg-gray-200/60 font-semibold text-white'\n              >\n                <svg\n                  xmlns='http://www.w3.org/2000/svg'\n                  fill='none'\n                  viewBox='0 0 24 24'\n                  strokeWidth='{1.5}'\n                  stroke='currentColor'\n                  className='h-6 w-6'\n                >\n                  <path strokeLinecap='round' strokeLinejoin='round' d='M8.25 4.5l7.5 7.5-7.5 7.5' />\n                </svg>\n              </button>\n            </div>\n          </div>\n\n          <div className='col-span-7'>\n            <h1 className='text-xl font-medium uppercase'>{product.name}</h1>\n            <div className='my-4 flex items-center'>\n              <div className='flex items-center gap-1'>\n                <span className='mt-1 text-orange underline'>{product.rating}</span>\n                <ProductRating\n                  rating={product.rating}\n                  classNameStartFilled='h-4 w-4 fill-orange text-orange'\n                  classNameNonStartFilled='h-4 w-4 fill-current text-gray-300'\n                />\n              </div>\n\n              <div className='mx-4 h-6 w-[1px] bg-gray-300' />\n\n              <div>\n                <span>{formatNumberToSocialStyle(product.sold)}</span>\n                <span className='ml-1 text-sm capitalize text-gray-500'>{t('sold')}</span>\n              </div>\n            </div>\n\n            <div className='flex items-center bg-gray-100 px-6 py-4'>\n              <span className='text-gray-500 line-through'>₫{formatCurrency(product.price_before_discount)}</span>\n\n              <div className='ml-3 text-3xl text-orange'>₫{formatCurrency(product.price)}</div>\n\n              <div className='ml-5 rounded-sm bg-orange px-1 text-sm font-semibold uppercase text-white'>\n                <span>{saleRate(product.price_before_discount, product.price)} </span>\n                {t('off')}\n              </div>\n            </div>\n\n            <div className='mt-6 flex items-center'>\n              <span className='capitalize text-gray-500'>{t('quantity')}</span>\n\n              <QuantityController\n                onDecrease={handleChangeQuantity}\n                onIncrease={handleChangeQuantity}\n                onType={handleChangeQuantity}\n                value={buyCount}\n                max={product.quantity}\n              />\n\n              <span className='ml-5 text-gray-500'>\n                {product.quantity} {t('pieces available')}\n              </span>\n            </div>\n\n            <div className='mt-6 flex items-center gap-4'>\n              <button\n                onClick={() => {\n                  handleAddToCart({ product_id: id, buy_count: buyCount });\n                }}\n                className='flex-items-center flex gap-2 rounded-sm border border-orange bg-orange/10 px-5 py-3 capitalize text-orange hover:bg-orange/20'\n              >\n                <svg\n                  xmlns='http://www.w3.org/2000/svg'\n                  fill='none'\n                  viewBox='0 0 24 24'\n                  strokeWidth='{1.5}'\n                  stroke='currentColor'\n                  className='h-5 w-5'\n                >\n                  <path\n                    strokeLinecap='round'\n                    strokeLinejoin='round'\n                    d='M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 00-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 00-16.536-1.84M7.5 14.25L5.106 5.272M6 20.25a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm12.75 0a.75.75 0 11-1.5 0 .75.75 0 011.5 0z'\n                  />\n                </svg>\n                {t('add to cart')}\n              </button>\n\n              <button\n                onClick={() => {\n                  buyNow({ product_id: id, buy_count: buyCount });\n                }}\n                className='rounded-sm bg-orange px-5 py-3 capitalize text-white hover:bg-orange/80'\n              >\n                {t('buy now')}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div className='container mt-4 bg-white'>\n        <div className='bg-gray-100/40 p-3 text-lg uppercase'>{t('product description')}</div>\n\n        <div className='p-3 text-sm leading-loose'>\n          <div dangerouslySetInnerHTML={{ __html: DOMPurify.sanitize(product.description as string) }} />\n        </div>\n      </div>\n      <div className='container mt-4'>\n        {productList && (\n          <div>\n            <div className='uppercase text-gray-500'>{t('you may also like')}</div>\n            <div className='mt-8 grid grid-cols-2 gap-4 sm:grid-cols-3 lg:grid-cols-5 xl:grid-cols-6'>\n              {productList.data.data.products.map((product: unknown) => (\n                <Product key={product._id} product={product} />\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n\n      <ToastSuccess\n        setShow={setShowToastSuccess}\n        show={showToastSuccess}\n        message='Sản phẩm đã được thêm vào Giỏ hàng'\n        duration={1500}\n      />\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}