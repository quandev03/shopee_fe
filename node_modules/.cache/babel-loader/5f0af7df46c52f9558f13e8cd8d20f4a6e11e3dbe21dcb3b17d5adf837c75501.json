{"ast":null,"code":"var _jsxFileName = \"/Volumes/MAC_Quandev03/Code/JS/Shopee/src/pages/ProductDetail/ProductDetail.tsx\",\n  _s = $RefreshSig$();\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\nimport DOMPurify from 'dompurify';\nimport { useEffect, useMemo, useRef, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { productApi } from 'src/api/product.api';\nimport { purchasesApi } from 'src/api/purchases.api';\nimport ToastSuccess from 'src/components/CustomToast/ToastSuccess';\nimport ProductRating from 'src/components/ProductRating';\nimport QuantityController from 'src/components/QuantityController';\nimport { path } from 'src/constants/path';\nimport { purchasesStatus } from 'src/constants/purchases';\nimport { formatCurrency, formatNumberToSocialStyle, getIdFromNameId, saleRate } from 'src/utils/utils';\nimport { useTranslation } from 'react-i18next';\nimport { Helmet } from 'react-helmet-async';\nimport { convert } from 'html-to-text';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ProductDetail() {\n  _s();\n  var _product$category;\n  const {\n    t\n  } = useTranslation('product');\n  const {\n    nameId\n  } = useParams();\n  const navigate = useNavigate();\n  const id = getIdFromNameId(nameId);\n  const queryClient = useQueryClient();\n  const {\n    data: productDetailData,\n    isLoading,\n    error\n  } = useQuery({\n    queryKey: ['product', id],\n    queryFn: () => {\n      return productApi.getProduct(id);\n    }\n  });\n\n  // Query API lấy danh sách sản phẩm\n  const {\n    data: productsData,\n    isLoading: productsLoading\n  } = useQuery({\n    queryKey: ['productList', {\n      page: '1'\n    }],\n    queryFn: () => productApi.getProductList(queryConfig),\n    keepPreviousData: true\n  });\n  console.log(productsData);\n  console.log(productDetailData);\n  const [showToastSuccess, setShowToastSuccess] = useState(false);\n  const [buyCount, setBuyCount] = useState(1);\n  const product = productDetailData === null || productDetailData === void 0 ? void 0 : productDetailData.data;\n  const queryConfig = {\n    page: '1',\n    category: product === null || product === void 0 ? void 0 : (_product$category = product.category) === null || _product$category === void 0 ? void 0 : _product$category._id\n  };\n  const {\n    data: productList\n  } = useQuery({\n    queryKey: ['productListCategory', queryConfig],\n    queryFn: () => {\n      return productApi.getProduct(id);\n    },\n    enabled: Boolean(product)\n  });\n  const imageRef = useRef(null);\n  const [currentImagesIndex, setCurrentImageIndex] = useState([0, 5]);\n  const [imageActived, setImageActived] = useState('');\n  console.log(product);\n  const currentImagesList = useMemo(() => {\n    if (!product) return [];\n    return product.images.slice(...currentImagesIndex);\n  }, [product, currentImagesIndex]);\n  const addToCartMutation = useMutation({\n    mutationFn: body => {\n      return purchasesApi.addToCart(body);\n    }\n  });\n  useEffect(() => {\n    if (product && product.images.length) {\n      setImageActived(product.images[0]);\n    }\n  }, [product]);\n  const activeImage = img => {\n    setImageActived(img);\n  };\n  const prevSlice = () => {\n    if (currentImagesIndex[0] <= 0) return;\n    setCurrentImageIndex(prev => [prev[0] - 1, prev[1] - 1]);\n  };\n  const nextSlice = () => {\n    if (currentImagesIndex[1] >= (product === null || product === void 0 ? void 0 : product.images.length)) return;\n    setCurrentImageIndex(prev => [prev[0] + 1, prev[1] + 1]);\n  };\n  const handleImageZoom = event => {\n    const rect = event.currentTarget.getBoundingClientRect();\n    const image = imageRef.current;\n    const {\n      naturalWidth,\n      naturalHeight\n    } = image;\n\n    //Cách 1: Lấy offsetX và offsetY đơn giản trong trường hợp xử lý được bubble event\n    // const { offsetX, offsetY } = event.nativeEvent;\n\n    //Cách 2: Tính toán offsetX và offsetY trong trường hợp không xử lý được bubble event đối với element con, ví dụ trường hợp element con là một component được import bên ngoài vào element cha\n\n    const offsetX = event.pageX - (rect.x + window.scrollX);\n    const offsetY = event.pageY - (rect.y + window.scrollY);\n    const top = offsetY * (1 - naturalHeight / rect.height);\n    const left = offsetX * (1 - naturalWidth / rect.width);\n    image.style.width = naturalWidth + 'px';\n    image.style.height = naturalHeight + 'px';\n    image.style.maxWidth = 'unset';\n    image.style.top = top + 'px';\n    image.style.left = left + 'px';\n  };\n  const handleRemoveZoom = () => {\n    var _imageRef$current;\n    (_imageRef$current = imageRef.current) === null || _imageRef$current === void 0 ? void 0 : _imageRef$current.removeAttribute('style');\n  };\n\n  // todo: thay đổi số lượng mua\n  const handleChangeQuantity = value => {\n    setBuyCount(value);\n  };\n\n  // todo thêm vào giỏ hàng\n  const handleAddToCart = body => {\n    addToCartMutation.mutate(body, {\n      onSuccess: () => {\n        // toast.success('Thêm vào giỏ hàng thành công', { autoClose: 1000 });\n        // customToast.renderToastSuccess({ duration: 1000 });\n        setShowToastSuccess(true);\n        queryClient.invalidateQueries({\n          queryKey: ['purchasesCart', {\n            status: purchasesStatus.inCart\n          }]\n        });\n      }\n    });\n  };\n  // Todo: nút mua ngay\n  const buyNow = async body => {\n    const res = await addToCartMutation.mutateAsync(body);\n    const purchase = res.data.data;\n    navigate(path.cart, {\n      state: {\n        purchaseId: purchase._id\n      }\n    });\n  };\n  if (isLoading) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"Loading...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 156,\n    columnNumber: 25\n  }, this);\n  if (error) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"Error loading product\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 157,\n    columnNumber: 21\n  }, this);\n  if (!product) return null;\n  return (\n    /*#__PURE__*/\n    // Todo: giao diện chi tiết sản phẩm\n    _jsxDEV(\"div\", {\n      className: \"relative bg-gray-100 py-3\",\n      children: [/*#__PURE__*/_jsxDEV(Helmet, {\n        children: [/*#__PURE__*/_jsxDEV(\"title\", {\n          children: product.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"meta\", {\n          name: \"description\",\n          content: convert(product.description || '', {\n            limits: {\n              maxInputLength: 200\n            }\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 165,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container bg-white shadow\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"grid grid-cols-12 gap-9\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-span-5\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"relative w-full cursor-zoom-in overflow-hidden pt-[100%] shadow\",\n              onMouseMove: handleImageZoom,\n              onMouseLeave: handleRemoveZoom,\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: imageActived,\n                alt: product.name,\n                className: \"absolute left-0 top-0 h-full w-full  bg-white object-cover\",\n                ref: imageRef\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 183,\n                columnNumber: 15\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 178,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"relative mt-4 grid w-full grid-cols-5 gap-5\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: prevSlice,\n                className: \"absolute left-0 top-1/2 z-10 h-9 w-5 -translate-y-1/2 bg-gray-200/60 font-semibold text-white\",\n                children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                  xmlns: \"http://www.w3.org/2000/svg\",\n                  fill: \"none\",\n                  viewBox: \"0 0 24 24\",\n                  strokeWidth: \"{1.5}\",\n                  stroke: \"currentColor\",\n                  className: \"h-6 w-6\",\n                  children: /*#__PURE__*/_jsxDEV(\"path\", {\n                    strokeLinecap: \"round\",\n                    strokeLinejoin: \"round\",\n                    d: \"M15.75 19.5L8.25 12l7.5-7.5\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 204,\n                    columnNumber: 19\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 196,\n                  columnNumber: 17\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 192,\n                columnNumber: 15\n              }, this), currentImagesList.map(image => {\n                const isActive = image === imageActived;\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"relative w-full cursor-pointer pt-[100%]\",\n                  onMouseEnter: () => activeImage(image),\n                  children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                    src: image,\n                    alt: image,\n                    className: \"absolute left-0 top-0 w-full object-contain\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 217,\n                    columnNumber: 21\n                  }, this), isActive && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"absolute left-0 top-0 h-full w-full border border-orange bg-transparent\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 219,\n                    columnNumber: 23\n                  }, this)]\n                }, image, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 212,\n                  columnNumber: 19\n                }, this);\n              }), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: nextSlice,\n                className: \"absolute right-0 top-1/2 z-10 h-9 w-5 -translate-y-1/2 bg-gray-200/60 font-semibold text-white\",\n                children: /*#__PURE__*/_jsxDEV(\"svg\", {\n                  xmlns: \"http://www.w3.org/2000/svg\",\n                  fill: \"none\",\n                  viewBox: \"0 0 24 24\",\n                  strokeWidth: \"{1.5}\",\n                  stroke: \"currentColor\",\n                  className: \"h-6 w-6\",\n                  children: /*#__PURE__*/_jsxDEV(\"path\", {\n                    strokeLinecap: \"round\",\n                    strokeLinejoin: \"round\",\n                    d: \"M8.25 4.5l7.5 7.5-7.5 7.5\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 237,\n                    columnNumber: 19\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 229,\n                  columnNumber: 17\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 225,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-span-7\",\n            children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n              className: \"text-xl font-medium uppercase\",\n              children: product.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"my-4 flex items-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"flex items-center gap-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"mt-1 text-orange underline\",\n                  children: product.rating\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 247,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(ProductRating, {\n                  rating: product.rating,\n                  classNameStartFilled: \"h-4 w-4 fill-orange text-orange\",\n                  classNameNonStartFilled: \"h-4 w-4 fill-current text-gray-300\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 248,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 246,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"mx-4 h-6 w-[1px] bg-gray-300\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 255,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: formatNumberToSocialStyle(product.soldQuantity)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 258,\n                  columnNumber: 17\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"ml-1 text-sm capitalize text-gray-500\",\n                  children: t('sold')\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 259,\n                  columnNumber: 17\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 257,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 245,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center bg-gray-100 px-6 py-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-gray-500 line-through\",\n                children: [\"\\u20AB\", formatCurrency(product.price)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 264,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ml-3 text-3xl text-orange\",\n                children: [\"\\u20AB\", formatCurrency(product.price)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 266,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"ml-5 rounded-sm bg-orange px-1 text-sm font-semibold uppercase text-white\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: [saleRate(Number(product.price), Number(product.price)), \" \"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 269,\n                  columnNumber: 17\n                }, this), t('off')]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 268,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-6 flex items-center\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"capitalize text-gray-500\",\n                children: t('quantity')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 275,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(QuantityController, {\n                onDecrease: handleChangeQuantity,\n                onIncrease: handleChangeQuantity,\n                onType: handleChangeQuantity,\n                value: buyCount,\n                max: product.quantity\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 277,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"ml-5 text-gray-500\",\n                children: [product.quantity, \" \", t('pieces available')]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 285,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"mt-6 flex items-center gap-4\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  handleAddToCart({\n                    product_id: id,\n                    buy_count: buyCount\n                  });\n                },\n                className: \"flex-items-center flex gap-2 rounded-sm border border-orange bg-orange/10 px-5 py-3 capitalize text-orange hover:bg-orange/20\",\n                children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n                  xmlns: \"http://www.w3.org/2000/svg\",\n                  fill: \"none\",\n                  viewBox: \"0 0 24 24\",\n                  strokeWidth: \"{1.5}\",\n                  stroke: \"currentColor\",\n                  className: \"h-5 w-5\",\n                  children: /*#__PURE__*/_jsxDEV(\"path\", {\n                    strokeLinecap: \"round\",\n                    strokeLinejoin: \"round\",\n                    d: \"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 00-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 00-16.536-1.84M7.5 14.25L5.106 5.272M6 20.25a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm12.75 0a.75.75 0 11-1.5 0 .75.75 0 011.5 0z\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 305,\n                    columnNumber: 19\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 297,\n                  columnNumber: 17\n                }, this), t('add to cart')]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 291,\n                columnNumber: 15\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => {\n                  buyNow({\n                    product_id: id,\n                    buy_count: buyCount\n                  });\n                },\n                className: \"rounded-sm bg-orange px-5 py-3 capitalize text-white hover:bg-orange/80\",\n                children: t('buy now')\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 314,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 290,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"container mt-4 bg-white\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-gray-100/40 p-3 text-lg uppercase\",\n          children: t('product description')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 327,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-3 text-sm leading-loose\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            dangerouslySetInnerHTML: {\n              __html: DOMPurify.sanitize(product.description)\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 330,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(ToastSuccess, {\n        setShow: setShowToastSuccess,\n        show: showToastSuccess,\n        message: \"S\\u1EA3n ph\\u1EA9m \\u0111\\xE3 \\u0111\\u01B0\\u1EE3c th\\xEAm v\\xE0o Gi\\u1ECF h\\xE0ng\",\n        duration: 1500\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 346,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 5\n    }, this)\n  );\n}\n_s(ProductDetail, \"WA5fQWtT4Ru94LkG9bmoquo6fbA=\", false, function () {\n  return [useTranslation, useParams, useNavigate, useQueryClient, useQuery, useQuery, useQuery, useMutation];\n});\n_c = ProductDetail;\nvar _c;\n$RefreshReg$(_c, \"ProductDetail\");","map":{"version":3,"names":["useMutation","useQuery","useQueryClient","DOMPurify","useEffect","useMemo","useRef","useState","useNavigate","useParams","productApi","purchasesApi","ToastSuccess","ProductRating","QuantityController","path","purchasesStatus","formatCurrency","formatNumberToSocialStyle","getIdFromNameId","saleRate","useTranslation","Helmet","convert","jsxDEV","_jsxDEV","ProductDetail","_s","_product$category","t","nameId","navigate","id","queryClient","data","productDetailData","isLoading","error","queryKey","queryFn","getProduct","productsData","productsLoading","page","getProductList","queryConfig","keepPreviousData","console","log","showToastSuccess","setShowToastSuccess","buyCount","setBuyCount","product","category","_id","productList","enabled","Boolean","imageRef","currentImagesIndex","setCurrentImageIndex","imageActived","setImageActived","currentImagesList","images","slice","addToCartMutation","mutationFn","body","addToCart","length","activeImage","img","prevSlice","prev","nextSlice","handleImageZoom","event","rect","currentTarget","getBoundingClientRect","image","current","naturalWidth","naturalHeight","offsetX","pageX","x","window","scrollX","offsetY","pageY","y","scrollY","top","height","left","width","style","maxWidth","handleRemoveZoom","_imageRef$current","removeAttribute","handleChangeQuantity","value","handleAddToCart","mutate","onSuccess","invalidateQueries","status","inCart","buyNow","res","mutateAsync","purchase","cart","state","purchaseId","children","fileName","_jsxFileName","lineNumber","columnNumber","className","name","content","description","limits","maxInputLength","onMouseMove","onMouseLeave","src","alt","ref","onClick","xmlns","fill","viewBox","strokeWidth","stroke","strokeLinecap","strokeLinejoin","d","map","isActive","onMouseEnter","rating","classNameStartFilled","classNameNonStartFilled","soldQuantity","price","Number","onDecrease","onIncrease","onType","max","quantity","product_id","buy_count","dangerouslySetInnerHTML","__html","sanitize","setShow","show","message","duration","_c","$RefreshReg$"],"sources":["/Volumes/MAC_Quandev03/Code/JS/Shopee/src/pages/ProductDetail/ProductDetail.tsx"],"sourcesContent":["import { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\nimport DOMPurify from 'dompurify';\nimport { Key, useEffect, useMemo, useRef, useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { productApi } from 'src/api/product.api';\nimport { purchasesApi } from 'src/api/purchases.api';\nimport ToastSuccess from 'src/components/CustomToast/ToastSuccess';\nimport ProductRating from 'src/components/ProductRating';\nimport QuantityController from 'src/components/QuantityController';\nimport { path } from 'src/constants/path';\nimport { purchasesStatus } from 'src/constants/purchases';\nimport { ProductListConfig, ProductType as ProductType } from 'src/@types/product.type';\nimport { ProductCart } from 'src/@types/purchases.type';\nimport { formatCurrency, formatNumberToSocialStyle, getIdFromNameId, saleRate } from 'src/utils/utils';\nimport Product from '../ProductList/components/Product';\nimport { useTranslation } from 'react-i18next';\nimport { Helmet } from 'react-helmet-async';\nimport { convert } from 'html-to-text';\n\nexport default function ProductDetail() {\n  const { t } = useTranslation('product');\n  const { nameId } = useParams();\n  const navigate = useNavigate();\n  const id = getIdFromNameId(nameId as string);\n  const queryClient = useQueryClient();\n  const { data: productDetailData, isLoading, error } = useQuery({\n    queryKey: ['product', id],\n    queryFn: () => {\n      return productApi.getProduct(id as string);\n    }\n  });\n\n  // Query API lấy danh sách sản phẩm\n  const { data: productsData, isLoading: productsLoading } = useQuery({\n    queryKey: ['productList', { page: '1' }],\n    queryFn: () => productApi.getProductList(queryConfig as ProductListConfig),\n    keepPreviousData: true\n  });\n  console.log(productsData);\n  \n  \n  \n\n  console.log(productDetailData);\n  const [showToastSuccess, setShowToastSuccess] = useState(false);\n\n  const [buyCount, setBuyCount] = useState(1);\n\n  const product = productDetailData?.data;\n\n  const queryConfig: ProductListConfig = { page: '1', category: product?.category?._id };\n\n  const { data: productList } = useQuery({\n    queryKey: ['productListCategory', queryConfig],\n    queryFn: () => {\n      return productApi.getProduct(id as string);\n    },\n    enabled: Boolean(product)\n  });\n\n  const imageRef = useRef<HTMLImageElement>(null);\n\n  const [currentImagesIndex, setCurrentImageIndex] = useState([0, 5]);\n\n  const [imageActived, setImageActived] = useState('');\n  console.log(product);\n  const currentImagesList = useMemo(() => {\n    if (!product) return [];\n    return product.images.slice(...currentImagesIndex);\n  }, [product, currentImagesIndex]);\n\n  const addToCartMutation = useMutation({\n    mutationFn: (body: ProductCart) => {\n      return purchasesApi.addToCart(body);\n    }\n  });\n\n  useEffect(() => {\n    if (product && product.images.length) {\n      setImageActived(product.images[0]);\n    }\n  }, [product]);\n\n  const activeImage = (img: string) => {\n    setImageActived(img);\n  };\n\n  const prevSlice = () => {\n    if (currentImagesIndex[0] <= 0) return;\n\n    setCurrentImageIndex((prev) => [prev[0] - 1, prev[1] - 1]);\n  };\n\n  const nextSlice = () => {\n    if (currentImagesIndex[1] >= (product as ProductType)?.images.length) return;\n\n    setCurrentImageIndex((prev) => [prev[0] + 1, prev[1] + 1]);\n  };\n\n  const handleImageZoom = (event: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n    const rect = event.currentTarget.getBoundingClientRect();\n\n    const image = imageRef.current as HTMLImageElement;\n    const { naturalWidth, naturalHeight } = image;\n\n    //Cách 1: Lấy offsetX và offsetY đơn giản trong trường hợp xử lý được bubble event\n    // const { offsetX, offsetY } = event.nativeEvent;\n\n    //Cách 2: Tính toán offsetX và offsetY trong trường hợp không xử lý được bubble event đối với element con, ví dụ trường hợp element con là một component được import bên ngoài vào element cha\n\n    const offsetX = event.pageX - (rect.x + window.scrollX);\n    const offsetY = event.pageY - (rect.y + window.scrollY);\n\n    const top = offsetY * (1 - naturalHeight / rect.height);\n    const left = offsetX * (1 - naturalWidth / rect.width);\n\n    image.style.width = naturalWidth + 'px';\n    image.style.height = naturalHeight + 'px';\n    image.style.maxWidth = 'unset';\n    image.style.top = top + 'px';\n    image.style.left = left + 'px';\n  };\n\n  const handleRemoveZoom = () => {\n    imageRef.current?.removeAttribute('style');\n  };\n\n  // todo: thay đổi số lượng mua\n  const handleChangeQuantity = (value: number) => {\n    setBuyCount(value);\n  };\n\n  // todo thêm vào giỏ hàng\n  const handleAddToCart = (body: ProductCart) => {\n    addToCartMutation.mutate(body, {\n      onSuccess: () => {\n        // toast.success('Thêm vào giỏ hàng thành công', { autoClose: 1000 });\n        // customToast.renderToastSuccess({ duration: 1000 });\n        setShowToastSuccess(true);\n        queryClient.invalidateQueries({ queryKey: ['purchasesCart', { status: purchasesStatus.inCart }] });\n      }\n    });\n  };\n// Todo: nút mua ngay\n  const buyNow = async (body: ProductCart) => {\n    const res = await addToCartMutation.mutateAsync(body);\n    const purchase = res.data.data;\n\n    navigate(path.cart, {\n      state: {\n        purchaseId: purchase._id\n      }\n    });\n  };\n\n  if (isLoading) return <div>Loading...</div>;\n  if (error) return <div>Error loading product</div>;\n  if (!product) return null;\n\n  return (\n    // Todo: giao diện chi tiết sản phẩm\n    <div className='relative bg-gray-100 py-3'>\n      <Helmet>\n        <title>{product.name}</title>\n        <meta\n          name='description'\n          content={convert(product.description || '', {\n            limits: {\n              maxInputLength: 200\n            }\n          })}\n        />\n      </Helmet>\n\n      <div className='container bg-white shadow'>\n        <div className='grid grid-cols-12 gap-9'>\n          <div className='col-span-5'>\n            <div\n              className='relative w-full cursor-zoom-in overflow-hidden pt-[100%] shadow'\n              onMouseMove={handleImageZoom}\n              onMouseLeave={handleRemoveZoom}\n            >\n              <img\n                src={imageActived}\n                alt={product.name}\n                className='absolute left-0 top-0 h-full w-full  bg-white object-cover'\n                ref={imageRef}\n              />\n            </div>\n\n            <div className='relative mt-4 grid w-full grid-cols-5 gap-5'>\n              <button\n                onClick={prevSlice}\n                className='absolute left-0 top-1/2 z-10 h-9 w-5 -translate-y-1/2 bg-gray-200/60 font-semibold text-white'\n              >\n                <svg\n                  xmlns='http://www.w3.org/2000/svg'\n                  fill='none'\n                  viewBox='0 0 24 24'\n                  strokeWidth='{1.5}'\n                  stroke='currentColor'\n                  className='h-6 w-6'\n                >\n                  <path strokeLinecap='round' strokeLinejoin='round' d='M15.75 19.5L8.25 12l7.5-7.5' />\n                </svg>\n              </button>\n\n              {currentImagesList.map((image: string) => {\n                const isActive = image === imageActived;\n\n                return (\n                  <div\n                    className='relative w-full cursor-pointer pt-[100%]'\n                    key={image}\n                    onMouseEnter={() => activeImage(image)}\n                  >\n                    <img src={image} alt={image} className='absolute left-0 top-0 w-full object-contain' />\n                    {isActive && (\n                      <div className='absolute left-0 top-0 h-full w-full border border-orange bg-transparent' />\n                    )}\n                  </div>\n                );\n              })}\n\n              <button\n                onClick={nextSlice}\n                className='absolute right-0 top-1/2 z-10 h-9 w-5 -translate-y-1/2 bg-gray-200/60 font-semibold text-white'\n              >\n                <svg\n                  xmlns='http://www.w3.org/2000/svg'\n                  fill='none'\n                  viewBox='0 0 24 24'\n                  strokeWidth='{1.5}'\n                  stroke='currentColor'\n                  className='h-6 w-6'\n                >\n                  <path strokeLinecap='round' strokeLinejoin='round' d='M8.25 4.5l7.5 7.5-7.5 7.5' />\n                </svg>\n              </button>\n            </div>\n          </div>\n\n          <div className='col-span-7'>\n            <h1 className='text-xl font-medium uppercase'>{product.name}</h1>\n            <div className='my-4 flex items-center'>\n              <div className='flex items-center gap-1'>\n                <span className='mt-1 text-orange underline'>{product.rating}</span>\n                <ProductRating\n                  rating={product.rating}\n                  classNameStartFilled='h-4 w-4 fill-orange text-orange'\n                  classNameNonStartFilled='h-4 w-4 fill-current text-gray-300'\n                />\n              </div>\n\n              <div className='mx-4 h-6 w-[1px] bg-gray-300' />\n\n              <div>\n                <span>{formatNumberToSocialStyle(product.soldQuantity)}</span>\n                <span className='ml-1 text-sm capitalize text-gray-500'>{t('sold')}</span>\n              </div>\n            </div>\n\n            <div className='flex items-center bg-gray-100 px-6 py-4'>\n              <span className='text-gray-500 line-through'>₫{formatCurrency(product.price)}</span>\n\n              <div className='ml-3 text-3xl text-orange'>₫{formatCurrency(product.price)}</div>\n\n              <div className='ml-5 rounded-sm bg-orange px-1 text-sm font-semibold uppercase text-white'>\n                <span>{saleRate(Number(product.price), Number(product.price))} </span>\n                {t('off')}\n              </div>\n            </div>\n\n            <div className='mt-6 flex items-center'>\n              <span className='capitalize text-gray-500'>{t('quantity')}</span>\n\n              <QuantityController\n                onDecrease={handleChangeQuantity}\n                onIncrease={handleChangeQuantity}\n                onType={handleChangeQuantity}\n                value={buyCount}\n                max={product.quantity}\n              />\n\n              <span className='ml-5 text-gray-500'>\n                {product.quantity} {t('pieces available')}\n              </span>\n            </div>\n\n            <div className='mt-6 flex items-center gap-4'>\n              <button\n                onClick={() => {\n                  handleAddToCart({ product_id: id, buy_count: buyCount });\n                }}\n                className='flex-items-center flex gap-2 rounded-sm border border-orange bg-orange/10 px-5 py-3 capitalize text-orange hover:bg-orange/20'\n              >\n                <svg\n                  xmlns='http://www.w3.org/2000/svg'\n                  fill='none'\n                  viewBox='0 0 24 24'\n                  strokeWidth='{1.5}'\n                  stroke='currentColor'\n                  className='h-5 w-5'\n                >\n                  <path\n                    strokeLinecap='round'\n                    strokeLinejoin='round'\n                    d='M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 00-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 00-16.536-1.84M7.5 14.25L5.106 5.272M6 20.25a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm12.75 0a.75.75 0 11-1.5 0 .75.75 0 011.5 0z'\n                  />\n                </svg>\n                {t('add to cart')}\n              </button>\n\n              <button\n                onClick={() => {\n                  buyNow({ product_id: id, buy_count: buyCount });\n                }}\n                className='rounded-sm bg-orange px-5 py-3 capitalize text-white hover:bg-orange/80'\n              >\n                {t('buy now')}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div className='container mt-4 bg-white'>\n        <div className='bg-gray-100/40 p-3 text-lg uppercase'>{t('product description')}</div>\n\n        <div className='p-3 text-sm leading-loose'>\n          <div dangerouslySetInnerHTML={{ __html: DOMPurify.sanitize(product.description as string) }} />\n        </div>\n      </div>\n      {/* <div className='container mt-4'>\n        {productList && (\n          <div>\n            <div className='uppercase text-gray-500'>{t('you may also like')}</div>\n            <div className='mt-8 grid grid-cols-2 gap-4 sm:grid-cols-3 lg:grid-cols-5 xl:grid-cols-6'>\n              {productList.data.data.products.map((product: ProductType) => (\n                <Product key={product.id} product={product} />\n              ))}\n            </div>\n          </div>\n        )}\n      </div> */}\n\n      <ToastSuccess\n        setShow={setShowToastSuccess}\n        show={showToastSuccess}\n        message='Sản phẩm đã được thêm vào Giỏ hàng'\n        duration={1500}\n      />\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}